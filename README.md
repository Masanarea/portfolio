
# URL 一覧  
ポートフォリオ (PC専用)  
https://www.laravelvueport.link/login

GitHub  
https://github.com/Masanarea/portfolio.git

Instagram(ポートフォリオ以外の Web アプリ作品投稿、アウトプット用)  
https://instagram.com/masa_626_/

# アプリケーション概要  
**食べログに特化した SNS アプリです。**


# アプリケーションの制作経緯  
前々からインスタグラムに上げられるような飲食店での食事の写真のみを集めたSNSアプリがあったらいいなという考えから制作しました。インスタグラムのような直感的にわかりやすい機能を実装したり、Google Mapのレビューのように誰でも抵抗感なく気軽にコメントを書ける機能を兼ね備えました。今後も、アプリを使用することで少しでも『この店に行ってみたい！』『この料理美味しそうだなぁ』と少しでも感じてもらえるようなWebアプリに改良していけたらと考えています。現在では、実際に友人に使ってもらった際の感想を参考にして、日々改良を重ねています。
長期的には GoogleMap や インスタグラム での食事関連のもの以上に『この店に行ってみたい！』と思ってもらうことを目標にアプリ制作を続けていけたらと考えています。
アプリの機能面やその数、UI部分はまだまだなのですが、今後もこのアプリの保守・運用を続けて行きたいと思います。


## アプリケーション詳細

こちらのアプリを作成する上で気をつけた事は、以下の２点です。

1. 現場で使われやすいモダンな技術を取り入れる
1. ページ反映と機能(コメントやいいね機能)の速度でユーザーに不快感を与えないようにする


このアプリには Instagram のような写真投稿、コメント、いいね機能のある SNS ですが、
その他に以下のような特徴のあるアプリです。

- 投稿された写真のダウンロード機能(FileReader API、　FormData API を使用)
- フロント側を Vue.js で作成、 インフラに AWS　を使用する事で　ページ反映の速度を高速化
- ページネーション機能 (写真６枚ごと)




## 使用画面のイメージ

![firstTime](https://user-images.githubusercontent.com/93495976/158014699-74fb7ba7-4ab5-4577-af93-be6a95d71ae3.gif)

## 使用技術

フロントエンドを Vue.js 、 バックエンドをPHP(Laravel)で作成し、 
Docker, CircleCI, AWS等のモダンなインフラ技術を一から学んで、Webアプリを作成
「新しい技術をどんどん使ってみたい！」という技術に対する好奇心、探究心は人一倍強い自負があります

- **具体的なモダンな技術一覧**

  - **Laravel + Vue.js の構成**
  - **Dockerで実行環境をコンテナ化**
  - **Herokuではなく、AWS でアプリをデプロイ**
  - **Circle CIによるCI/CDパイプラインの構築**


- **具体的なページ反映と機能(コメントやいいね機能)の速度で高速化**

  - **Herokuにデプロイでは遅いのでAWS**
  - **フロントエンドに Vue.js(Ajaxによる非同期通信) **


- **フロントエンド**

  - **Vue.js 2.6.14**
  - **JavaScript**
  - **HTML / SCC /**

- **バックエンド**

  - **PHP 7.4.1**
  - **Laravel 6.20.26**
  - **PHPUnit 9.5.16**

- **インフラ**

  - **CircleCi**
  - **Docker 20.10.12 / docker-compose 2.2.3**
  - **nginx 1.18**
  - **mysql 5.7.31**
  - **AWS** ( EC2, ALB, ACM, S3, RDS, Route53, VPC, EIP, IAM )

- その他使用ツール
  - Visual Studio Code
  - SourceTree(コマンドでGitを使うこともありましたが、主に SourceTree を使用)
  - Slack
  - GitHub
  - Notion （開発中に参考になった記事を管理）

- GitHub や CircleCi の利用において
  - master ブランチと feature ブランチの二つを用意して作業を進める
  - 機能を追加する際に Issue を利用
  - feature ブランチ でtestが通らない場合、master ブランチにマージできないように設定
  - CircleCi のテスト結果を Slack に通知


## AWS 構成図

![AWS-ER](https://user-images.githubusercontent.com/93495976/158013902-1ffd9fab-9069-4fa8-9123-dd0428ea287c.png)



## 機能一覧

- **一般ユーザー登録関連**

  - アカウント新規登録
  - ログイン、ログアウト機能





- **ページネーション機能**


- **ユーザー投稿関連(CRUD)**

- **コメント機能**

- **いいね機能** (Vue.js / ajax)




- **フラッシュメッセージ表示機能** (jQuery/ Toastr)

  - 投稿、編集、削除、ログイン、ログアウト時にフラッシュメッセージを表示

- **画像アップロード機能** (AWS S3 バケット)

- **PHPUnit テスト**

### 各テストについて

|    テスト    |                      内容                      |
| :--------------: | :--------------------------------------------: |
|      AddCommentApiTest       |                コメントを追加できるかどうかのテスト               |
|      LikeApiTest      |               いいねの追加、いいねの解除、2回同じ写真にいいねしても1回しかいいねがつかないかを確認するテスト              |
|     LoginApiTest      |      コメントを追加できるかどうかのテスト       |
| LogoutApiTest | コメントを追加できるかどうかのテスト |
|     RegisterApiTest     |               コメントを追加できるかどうかのテスト               |
|       UserApiTest       |             コメントを追加できるかどうかのテスト             |

## DB 設計

### ER 図
![er drawio](https://user-images.githubusercontent.com/93495976/158013946-d3934509-480a-40d0-b8b8-f00a99c86fd5.png)


### 各テーブルについて

|    テーブル名    |                      説明                      |
| :--------------: | :--------------------------------------------: |
|      users       |                ユーザー情報                |
|      photos      |               登録した写真情報（12桁のランダムな値をidとして管理）               |
|     comments      |      コメント情報       |
| likes | いいね機能に関する情報 |


### 早起き達成機能 関連のポイント

**users テーブル**の`wake_up_time`はユーザーの**目標起床時間**を意味しています。
この時間よりも早い時間にユーザーが投稿をできれば、その日の早起きが達成となります。
なお、
「目標起床時間が 07:00 で、深夜 1:00 に投稿した」
というように、早過ぎる時間にユーザーが投稿した
場合にも早起き達成とならないように設定しています。
その仕組みとして、**users テーブル**の`range_of_success`の値が利用されています。
これは、
「目標起床時間より何時間前までに投稿すれば早起き達成となるのか、その範囲を表す整数値」
です。
デフォルトは`3`で、例えば目標起床時間を**07:00**に設定している場合は、その 3 時間前の
**04:00 〜 07:00** の間に投稿できれば早起き達成となります。

こうして早起き達成をすることができたら、**achievement_days テーブル**の`date`に達成日の日付が履歴として記録されていきます。
`例） 2020-11-22`
この日付データを利用して、以下の機能を実現しています。

**① 　 1 ヶ月毎の早起き達成日数を算出** <br>
**② 　 ① の日数を利用したランキング機能**

当初は、早起き**継続**日数のランキングにしようかとも考えていましたが、
ユーザーのモチベーション維持等の観点から**1 ヶ月毎**の早起き**達成**日数を採用することにしました。

※朝活アプリなので、もともとは目標起床時間 04:00~10:00 の間しか設定できない仕様ですが、
現在は「早起き達成判定」機能を好きな時間にお試しいただけるよう、時間設定を自由にできるようにしています。


今後の課題
かなりあるのですが、優先してこの機能は必要だと思うものを挙げて行きたいと思います

コメントの編集機能
コメントの削除機能
コメントで改行を使えるようにする
コメントで絵文字を使えるようにする
まだまだ課題も多いのですが、一つずつ改善してよりブラッシュアップしていきたく思います。








API
URL メソッド 認証 内容
/api/photos GET 写真 一覧取得
/api/photos POST 写真 投稿
/api/photos/{写真 ID} GET 写真 詳細取得
/api/photos/{写真 ID}/like PUT 写真 いいね追加
/api/photos/{写真 ID}/like DELETE 写真 いいね解除
/api/photos/{写真 ID}/comments POST 写真 コメント追加
/api/register POST 会員登録
/api/login POST ログイン
/api/logout POST ログアウト
/api/user GET 認証ユーザー取得

バックエンド
API 以外のサーバサイドで用意する必要がある URL
URL メソッド 認証 内容
/ GET 最初に HTML を返却する
/photos/{写真 ID}/download GET 写真ダウンロード
フロントエンド
Vue Router で実現します。
URL 内容
/ 写真一覧ページ
/photos/{写真 ID} 写真詳細ページ
/login ログイン・会員登録ページ

複数のミドルウェア（今回だと Nginx、MySQL、PHP）のコンテナを作成・管理する場合は Docker Compose を使います。

axios・・・Javascript ライブラリ

id => mHAoeS-GOBpf

FileReader API

FormData API

import { OK } from '../util'

// トランザクション

フォームリクエストクラスを作成

アクセサ

ページ遷移時にページ先頭を表示

status

エラー機能
